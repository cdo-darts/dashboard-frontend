import{b as ue,_ as S,a as F,V as U}from"./VContainer-CozXF2iI.js";import{D as re,E as G,bm as ce,bn as me,G as ve,H as fe,I as pe,h as t,J as K,K as ye,a2 as W,r as c,L as ge,f as o,T as Q,p as X,af as be,bo as he,C as g,bp as _e,l as se,F as ke,_ as xe,bq as we,x as Ve,o as Ce,c as N,w as s,br as Se,bs as Ue,u as Te,s as B,e as y,k as R,i as u,bt as Ae,V as T,j as I,t as Y,v as Pe,bu as De,bv as Fe}from"./index-DkC98IVe.js";import{V as Ie,a as Z}from"./VRow-Bn5hU226.js";import{u as Ne,V as ee,b as te,c as Be,m as Re,a as ae}from"./VTextField-bdlUX8kG.js";import{V as le}from"./VAlert-BVTgDk4S.js";const Me=ge({indeterminate:Boolean,inset:Boolean,flat:Boolean,loading:{type:[Boolean,String],default:!1},...Re(),...Be()},"VSwitch"),M=re()({name:"VSwitch",inheritAttrs:!1,props:Me(),emits:{"update:focused":i=>!0,"update:modelValue":i=>!0,"update:indeterminate":i=>!0},setup(i,b){let{attrs:m,slots:d}=b;const v=G(i,"indeterminate"),r=G(i,"modelValue"),{loaderClasses:w}=ce(i),{isFocused:f,focus:h,blur:_}=Ne(i),k=c(),l=c(),x=me&&window.matchMedia("(forced-colors: active)").matches,z=W(()=>typeof i.loading=="string"&&i.loading!==""?i.loading:i.color),V=ve(),E=W(()=>i.id||`switch-${V}`);function A(){v.value&&(v.value=!1)}function H(C){C.stopPropagation(),C.preventDefault(),k.value?.input?.click()}return fe(()=>{const[C,P]=pe(m),L=ee.filterProps(i),$=te.filterProps(i);return t(ee,K({ref:l,class:["v-switch",{"v-switch--flat":i.flat},{"v-switch--inset":i.inset},{"v-switch--indeterminate":v.value},w.value,i.class]},C,L,{modelValue:r.value,"onUpdate:modelValue":a=>r.value=a,id:E.value,focused:f.value,style:i.style}),{...d,default:a=>{let{id:e,messagesId:n,isDisabled:oe,isReadonly:ie,isValid:q}=a;const J={model:r,isValid:q};return t(te,K({ref:k},$,{modelValue:r.value,"onUpdate:modelValue":[D=>r.value=D,A],id:e.value,"aria-describedby":n.value,type:"checkbox","aria-checked":v.value?"mixed":void 0,disabled:oe.value,readonly:ie.value,onFocus:h,onBlur:_},P),{...d,default:D=>{let{backgroundColorClasses:O,backgroundColorStyles:p}=D;return o("div",{class:X(["v-switch__track",x?void 0:O.value]),style:Q(p.value),onClick:H},[d["track-true"]&&o("div",{key:"prepend",class:"v-switch__track-true"},[d["track-true"](J)]),d["track-false"]&&o("div",{key:"append",class:"v-switch__track-false"},[d["track-false"](J)])])},input:D=>{let{inputNode:O,icon:p,backgroundColorClasses:ne,backgroundColorStyles:de}=D;return o(ke,null,[O,o("div",{class:X(["v-switch__thumb",{"v-switch__thumb--filled":p||i.loading},i.inset||x?void 0:ne.value]),style:Q(i.inset?void 0:de.value)},[d.thumb?t(be,{defaults:{VIcon:{icon:p,size:"x-small"}}},{default:()=>[d.thumb({...J,icon:p})]}):t(he,null,{default:()=>[i.loading?t(_e,{name:"v-switch",active:!0,color:q.value===!1?void 0:z.value},{default:j=>d.loader?d.loader(j):t(se,{active:j.isActive,color:j.color,indeterminate:!0,size:"16",width:"2"},null)}):p&&t(g,{key:String(p),icon:p,size:"x-small"},null)]})])])}})}})}),ye({},l)}}),ze={key:0,class:"text-center py-16"},Ee={key:1},He={class:"d-flex flex-column ga-3"},Le={class:"d-flex flex-wrap ga-2"},$e={class:"text-body-2"},Je={key:0,class:"text-caption mt-1"},Oe={key:0},je={class:"mb-6"},qe={class:"mb-6"},Ge={class:"d-flex flex-column flex-sm-row gap-3 justify-end"},Ke={__name:"settings",setup(i){const{success:b,error:m}=Te(),d=we(),v=c(!1),r=c(!1),w=c(!1),f=c(null),h=c(!1),_=c(!1),k=c(null),l=c({auto_update:{enabled:!1,check_interval_hours:24,check_time:"03:00",auto_install:!1},notifications:{update_available:!0,installation_complete:!0},display:{theme:"dark",refresh_interval_seconds:5}});function x(a){const e=a==="light"?"light":"dark";d.change(e),localStorage.setItem("vertex-theme",e)}Ve(()=>l.value.display.theme,a=>{x(a)});const z=B(()=>f.value?JSON.stringify(f.value)!==JSON.stringify(l.value):!1),V=B(()=>(k.value?.components||[]).some(a=>a.update_available)),E=B(()=>{const a=(k.value?.components||[]).find(e=>e.update_available);return a?`${a.name}: ${a.current_version} â†’ ${a.latest_version}`:""}),A=B(()=>k.value?V.value?{type:"warning",message:'Update available. Click "Update now" to install.'}:{type:"success",message:"Device is up to date."}:null);async function H(){try{v.value=!0;const a=await Se();f.value=a.data,l.value=structuredClone(a.data),l.value.display.refresh_interval_seconds=5,x(l.value.display.theme)}catch(a){m("Failed to load settings: "+a.message)}finally{v.value=!1}}async function C(){try{r.value=!0,l.value.display.refresh_interval_seconds=5;const a=await Fe(l.value);f.value=a.data.settings,l.value=structuredClone(a.data.settings),l.value.display.refresh_interval_seconds=5,x(l.value.display.theme),b("Settings saved successfully")}catch(a){m("Failed to save settings: "+a.message)}finally{r.value=!1}}async function P(){try{h.value=!0;const a=await Ue();k.value=a.data,V.value?b("Update available"):b("Device is up to date")}catch(a){m("Failed to check for updates: "+a.message)}finally{h.value=!1}}async function L(){try{_.value=!0,(await Pe()).data?.success?b("Update command executed successfully"):m("Update command failed"),await P()}catch(a){m("Failed to apply updates: "+a.message)}finally{_.value=!1}}async function $(){if(confirm("Are you sure you want to reset all settings to defaults?"))try{w.value=!0;const a=await De();f.value=a.data.settings,l.value=structuredClone(a.data.settings),l.value.display.refresh_interval_seconds=5,x(l.value.display.theme),b("Settings reset to defaults")}catch(a){m("Failed to reset settings: "+a.message)}finally{w.value=!1}}return Ce(async()=>{await H(),await P()}),(a,e)=>(y(),N(ue,{class:"pa-4 pa-md-6",fluid:""},{default:s(()=>[e[27]||(e[27]=o("div",{class:"mb-6"},[o("h1",{class:"text-h4 text-md-h3 text-primary-high font-weight-bold mb-1"},"Settings"),o("p",{class:"text-body-2 text-secondary"},"Configure theme, notifications, and auto-update behavior")],-1)),v.value&&!f.value?(y(),R("div",ze,[t(se,{color:"primary",indeterminate:"",size:"64"}),e[7]||(e[7]=o("div",{class:"text-body-1 text-secondary mt-4"},"Loading settings...",-1))])):(y(),R("div",Ee,[t(Ie,null,{default:s(()=>[t(Z,{cols:"12",lg:"6"},{default:s(()=>[t(S,{class:"mb-4",elevated:""},{default:s(()=>[t(F,{class:"text-primary-high d-flex align-center"},{default:s(()=>[t(g,{class:"mr-2",icon:"mdi-palette"}),e[8]||(e[8]=u("Display Settings ",-1))]),_:1}),t(U,null,{default:s(()=>[o("div",null,[e[11]||(e[11]=o("div",{class:"text-body-2 text-primary-medium mb-3"},"Theme",-1)),t(Ae,{modelValue:l.value.display.theme,"onUpdate:modelValue":e[0]||(e[0]=n=>l.value.display.theme=n),class:"w-100",color:"primary",divided:"",mandatory:"",variant:"outlined"},{default:s(()=>[t(T,{class:"flex-1-1",value:"dark"},{default:s(()=>[t(g,{class:"mr-2",icon:"mdi-weather-night"}),e[9]||(e[9]=u("Dark",-1))]),_:1}),t(T,{class:"flex-1-1",value:"light"},{default:s(()=>[t(g,{class:"mr-2",icon:"mdi-white-balance-sunny"}),e[10]||(e[10]=u("Light",-1))]),_:1})]),_:1},8,["modelValue"]),e[12]||(e[12]=o("div",{class:"text-caption text-secondary mt-3"},"Dashboard data refresh is fixed at every 5 seconds.",-1))])]),_:1})]),_:1}),t(S,{class:"mb-4"},{default:s(()=>[t(F,{class:"text-primary-high d-flex align-center"},{default:s(()=>[t(g,{class:"mr-2",icon:"mdi-bell"}),e[13]||(e[13]=u("Notifications",-1))]),_:1}),t(U,null,{default:s(()=>[t(M,{modelValue:l.value.notifications.update_available,"onUpdate:modelValue":e[1]||(e[1]=n=>l.value.notifications.update_available=n),class:"mb-4",color:"primary","hide-details":"",label:"Notify when updates are available"},null,8,["modelValue"]),t(M,{modelValue:l.value.notifications.installation_complete,"onUpdate:modelValue":e[2]||(e[2]=n=>l.value.notifications.installation_complete=n),color:"primary","hide-details":"",label:"Notify when installation completes"},null,8,["modelValue"])]),_:1})]),_:1}),t(S,null,{default:s(()=>[t(F,{class:"text-primary-high d-flex align-center"},{default:s(()=>[t(g,{class:"mr-2",icon:"mdi-wifi"}),e[14]||(e[14]=u("Network Setup ",-1))]),_:1}),t(U,null,{default:s(()=>[...e[15]||(e[15]=[o("p",{class:"text-body-2 text-secondary mb-0"}," Network onboarding is now handled by the backend host flow before the dashboard loads. ",-1)])]),_:1})]),_:1}),t(S,{class:"mt-4"},{default:s(()=>[t(F,{class:"text-primary-high d-flex align-center"},{default:s(()=>[t(g,{class:"mr-2",icon:"mdi-update"}),e[16]||(e[16]=u("Check for Updates ",-1))]),_:1}),t(U,null,{default:s(()=>[o("div",He,[e[19]||(e[19]=o("p",{class:"text-body-2 text-secondary mb-0"},"Use this to check for software updates and apply them manually.",-1)),o("div",Le,[t(T,{color:"primary",disabled:h.value||_.value,loading:h.value,"prepend-icon":"mdi-refresh",variant:"outlined",onClick:P},{default:s(()=>[...e[17]||(e[17]=[u("Check for updates",-1)])]),_:1},8,["disabled","loading"]),V.value?(y(),N(T,{key:0,color:"warning",disabled:h.value||_.value,loading:_.value,"prepend-icon":"mdi-download",onClick:L},{default:s(()=>[...e[18]||(e[18]=[u("Update now",-1)])]),_:1},8,["disabled","loading"])):I("",!0)]),A.value?(y(),N(le,{key:0,density:"comfortable",type:A.value.type,variant:"tonal"},{default:s(()=>[o("div",$e,Y(A.value.message),1),V.value?(y(),R("div",Je,Y(E.value),1)):I("",!0)]),_:1},8,["type"])):I("",!0)])]),_:1})]),_:1})]),_:1}),t(Z,{cols:"12",lg:"6"},{default:s(()=>[t(S,{elevated:""},{default:s(()=>[t(F,{class:"text-primary-high d-flex align-center"},{default:s(()=>[t(g,{class:"mr-2",icon:"mdi-update"}),e[20]||(e[20]=u("Auto-Update Settings",-1))]),_:1}),t(U,null,{default:s(()=>[t(M,{modelValue:l.value.auto_update.enabled,"onUpdate:modelValue":e[3]||(e[3]=n=>l.value.auto_update.enabled=n),class:"mb-6",color:"primary","hide-details":"",label:"Enable automatic update checks"},null,8,["modelValue"]),l.value.auto_update.enabled?(y(),R("div",Oe,[o("div",je,[e[21]||(e[21]=o("div",{class:"text-body-2 text-primary-medium mb-3"},"Check Interval (hours)",-1)),t(ae,{modelValue:l.value.auto_update.check_interval_hours,"onUpdate:modelValue":e[4]||(e[4]=n=>l.value.auto_update.check_interval_hours=n),modelModifiers:{number:!0},density:"comfortable",hint:"How often to check for updates",min:1,"persistent-hint":"",type:"number",variant:"outlined"},null,8,["modelValue"])]),o("div",qe,[e[22]||(e[22]=o("div",{class:"text-body-2 text-primary-medium mb-3"},"Preferred Check Time",-1)),t(ae,{modelValue:l.value.auto_update.check_time,"onUpdate:modelValue":e[5]||(e[5]=n=>l.value.auto_update.check_time=n),density:"comfortable",hint:"Time of day to check for updates (HH:MM)","persistent-hint":"",type:"time",variant:"outlined"},null,8,["modelValue"])]),o("div",null,[t(M,{modelValue:l.value.auto_update.auto_install,"onUpdate:modelValue":e[6]||(e[6]=n=>l.value.auto_update.auto_install=n),color:"warning","hide-details":""},{label:s(()=>[...e[23]||(e[23]=[o("div",null,[o("div",{class:"text-body-2"},"Automatically install updates"),o("div",{class:"text-caption text-secondary"},"Updates will be installed without confirmation")],-1)])]),_:1},8,["modelValue"]),l.value.auto_update.auto_install?(y(),N(le,{key:0,class:"mt-3",density:"compact",icon:"mdi-alert",type:"warning",variant:"tonal"},{default:s(()=>[...e[24]||(e[24]=[o("div",{class:"text-caption"},"Warning: Updates will be installed automatically without your confirmation.",-1)])]),_:1})):I("",!0)])])):I("",!0)]),_:1})]),_:1})]),_:1})]),_:1}),t(S,{class:"mt-6"},{default:s(()=>[t(U,null,{default:s(()=>[o("div",Ge,[t(T,{color:"error",disabled:r.value,loading:w.value,"prepend-icon":"mdi-restore",variant:"outlined",onClick:$},{default:s(()=>[...e[25]||(e[25]=[u("Reset to Defaults",-1)])]),_:1},8,["disabled","loading"]),t(T,{color:"primary",disabled:w.value||!z.value,loading:r.value,"prepend-icon":"mdi-content-save",size:"large",onClick:C},{default:s(()=>[...e[26]||(e[26]=[u("Save Settings",-1)])]),_:1},8,["disabled","loading"])])]),_:1})]),_:1})]))]),_:1}))}},et=xe(Ke,[["__scopeId","data-v-e61603b8"]]);export{et as default};
