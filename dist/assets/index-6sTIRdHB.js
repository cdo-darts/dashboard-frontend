import{B as ie,C as de,D as ue,E as ce,G as ve,f as a,H as G,I as pe,r as d,J as fe,K as J,_ as me,q as ye,o as ge,a as be,c as D,w as l,s as xe,L as he,b as we,u as ke,x as _e,d as r,e as s,k as I,z as Ve,l as p,j as E,h as i,V as K,t as f,A as M,p as W,M as Ae,N as Ce,O as Ie}from"./index-CUlQIrP-.js";import{b as Se,_ as P,V as F,a as T}from"./VContainer-BWr7X9vz.js";import{_ as Ue}from"./StatusBadge-8zFFxfMT.js";import{V as Y}from"./VAlert-B6Jd7ZQv.js";import{V as Be,a as Q}from"./VRow-CCF6pCQE.js";import{V as Me}from"./VDivider-ixhQMt__.js";import{u as Le,V as X,a as Z,m as ze,b as Pe,c as Fe,d as $e}from"./VSelect-DQdBbZ3I.js";import"./VChip-BG6Su_jz.js";const Ne=fe({...J(Pe(),["direction"]),...J(ze(),["inline"])},"VCheckbox"),je=ie()({name:"VCheckbox",inheritAttrs:!1,props:Ne(),emits:{"update:modelValue":u=>!0,"update:focused":u=>!0},setup(u,$){let{attrs:k,slots:m}=$;const y=de(u,"modelValue"),{isFocused:o,focus:c,blur:S}=Le(u),b=d(),x=ue();return ce(()=>{const[_,V]=ve(k),U=X.filterProps(u),A=Z.filterProps(u);return a(X,G({ref:b,class:["v-checkbox",u.class]},_,U,{modelValue:y.value,"onUpdate:modelValue":v=>y.value=v,id:u.id||`checkbox-${x}`,focused:o.value,style:u.style}),{...m,default:v=>{let{id:h,messagesId:L,isDisabled:N,isReadonly:j,isValid:C}=v;return a(Z,G(A,{id:h.value,"aria-describedby":L.value,disabled:N.value,readonly:j.value},V,{error:C.value===!1,modelValue:y.value,"onUpdate:modelValue":w=>y.value=w,onFocus:c,onBlur:S}),m)}})}),pe({},b)}}),Re={class:"mb-4 d-flex flex-wrap align-center justify-space-between gap-3"},De={key:1,class:"text-center py-16"},Ee={key:2},Te={class:"d-flex align-center justify-space-between mb-4"},He={key:0},Oe={class:"d-flex justify-space-between align-center mb-3"},qe={class:"text-h6 text-primary-high font-weight-bold"},Ge={class:"d-flex justify-space-between align-center mb-3"},Je={class:"text-body-2 text-primary-medium"},Ke={class:"d-flex justify-space-between align-center"},We={key:1,class:"text-center py-6"},Ye={class:"text-caption text-secondary mt-2"},Qe={key:0,class:"text-caption text-secondary mt-1"},Xe=["href"],Ze={key:0},et={key:1},tt={key:0,class:"mb-4"},at={class:"text-body-2"},st={key:1,class:"text-center py-6"},lt={class:"d-flex gap-2"},ot={key:0,class:"text-center py-8"},nt={key:1,class:"logs-container"},rt={class:"logs-content"},it={key:2,class:"text-center py-8"},dt={__name:"index",setup(u){const $=_e(),{success:k,error:m}=ke(),y=d(!1),o=d(null),c=d(null),S=d(!1),b=d(!1),x=d(""),_=d(100),V=d(""),U=d(!0),A=d(""),v=d(null);let h=null;function L(){if(!o.value?.installed)return"Not Installed";const t=j(v.value?.status||v.value?.event);return t||(v.value?.connected?v.value?.running?"Running":"Stopped":o.value?.active?"Running":"Stopped")}function N(){const t=L().toLowerCase();return t==="running"?"success":t==="starting"?"info":t==="calibrating"?"warning":"neutral"}function j(t){const e=String(t||"").toLowerCase();return e?e.includes("start")?"Starting":e.includes("calibrat")?"Calibrating":e.includes("run")?"Running":e.includes("stop")?"Stopped":"":""}async function C(){try{y.value=!0;const t=await xe();o.value=t.data}catch(t){m("Failed to fetch Autodarts status: "+t.message)}finally{y.value=!1}}async function w(){try{b.value=!0;const t=await he(_.value);x.value=t.data?.logs||"No logs available"}catch(t){m("Failed to fetch logs: "+t.message),x.value="Failed to load logs"}finally{b.value=!1}}function ee(t){const e=window.location.protocol==="https:"?"https":"http",n="/api/state",g=n.startsWith("/")?n:`/${n}`;return`${e}://${t}:3180${g}`}async function H(){const e=ee("cdo-vertex.local");try{const n=await fetch(e,{cache:"no-store"});if(!n.ok)throw new Error("Board Manager request failed");v.value=await n.json()}catch{v.value=null}}function te(){h||(H(),h=setInterval(H,1e3))}function ae(){h&&(clearInterval(h),h=null)}const O=W(()=>"http://cdo-vertex.local:3180"),R=W(()=>A.value?`http://${A.value}:3180`:"");function se(t){const e=t?.interfaces||{},n=Object.entries(e).filter(([g])=>!g.toLowerCase().includes("lo")).sort(([g],[q])=>{const B=z=>z.includes("wlan")?0:z.includes("eth")?1:2;return B(g.toLowerCase())-B(q.toLowerCase())});for(const[,g]of n){const B=(Array.isArray(g?.addresses)?g.addresses:[]).find(z=>(z.type||"").toLowerCase()==="ipv4");if(B?.address)return B.address}return""}async function le(){try{const t=await we();A.value=se(t.data?.network)}catch{A.value=""}}async function oe(){try{c.value="install";const t={enable_autostart:U.value};V.value&&(t.version=V.value),await Ae(t),k("Autodarts installed successfully"),await C(),await w()}catch(t){m("Failed to install Autodarts: "+t.message)}finally{c.value=null}}async function ne(){try{c.value="update",await Ce(),k("Autodarts updated successfully"),await C(),await w()}catch(t){m("Failed to update Autodarts: "+t.message)}finally{c.value=null}}async function re(){try{S.value=!0;const t=await Ie();await C(),t.data?.update_available?k(`Update available: v${t.data.latest_version}`):k("No updates available")}catch(t){m("Failed to check for updates: "+t.message)}finally{S.value=!1}}return ye(_,()=>{o.value?.installed&&w()}),ge(async()=>{await C(),o.value?.installed&&await w(),await le(),te()}),be(()=>{ae()}),(t,e)=>(r(),D(Se,{class:"pa-4 pa-md-6",fluid:""},{default:l(()=>[s("div",Re,[e[5]||(e[5]=s("div",null,[s("h1",{class:"text-h4 text-md-h3 text-primary-high font-weight-bold mb-1"},"Autodarts"),s("p",{class:"text-body-2 text-secondary"},"Install, update, and control the Autodarts service")],-1)),a(I,{"prepend-icon":"mdi-arrow-left",variant:"text",onClick:e[0]||(e[0]=n=>Ve($).push("/apps"))},{default:l(()=>[...e[4]||(e[4]=[p("Back to Apps",-1)])]),_:1})]),o.value&&!o.value.manager_available?(r(),D(Y,{key:0,class:"mb-6",icon:"mdi-alert",prominent:"",type:"warning",variant:"tonal"},{default:l(()=>[...e[6]||(e[6]=[s("div",{class:"text-h6 mb-2"},"Autodarts Manager Not Found",-1),s("div",{class:"text-body-2"},"Autodarts Manager is not installed at /opt/autodarts-manager.",-1)])]),_:1})):E("",!0),y.value&&!o.value?(r(),i("div",De,[a(K,{color:"primary",indeterminate:"",size:"64"}),e[7]||(e[7]=s("div",{class:"text-body-1 text-secondary mt-4"},"Loading Autodarts status...",-1))])):(r(),i("div",Ee,[a(Be,null,{default:l(()=>[a(Q,{cols:"12",lg:"6"},{default:l(()=>[a(P,{class:"mb-4",elevated:""},{default:l(()=>[a(F,null,{default:l(()=>[s("div",Te,[s("div",null,[e[8]||(e[8]=s("div",{class:"text-caption text-secondary mb-2"},"Service Status",-1)),a(Ue,{variant:o.value?.installed?N():"neutral"},{default:l(()=>[p(f(L()),1)]),_:1},8,["variant"])]),a(M,{color:"primary",icon:"mdi-bullseye-arrow",size:"56",style:{opacity:"0.3"}})]),a(Me,{class:"my-4",style:{opacity:"0.1"}}),o.value?.installed?(r(),i("div",He,[s("div",Oe,[e[9]||(e[9]=s("span",{class:"text-body-2 text-secondary"},"Installed Version:",-1)),s("span",qe,"v"+f(o.value.version),1)]),s("div",Ge,[e[10]||(e[10]=s("span",{class:"text-body-2 text-secondary"},"Latest Version:",-1)),s("span",Je,"v"+f(o.value.latest_version),1)]),s("div",Ke,[e[11]||(e[11]=s("span",{class:"text-body-2 text-secondary"},"Autostart Enabled:",-1)),a(M,{color:o.value.enabled?"success":"secondary",icon:o.value.enabled?"mdi-check-circle":"mdi-close-circle",size:"20"},null,8,["color","icon"])])])):(r(),i("div",We,[a(M,{color:"secondary",icon:"mdi-package-variant",size:"64",style:{opacity:"0.3"}}),e[12]||(e[12]=s("div",{class:"text-body-2 text-secondary mt-3"},"Autodarts is not installed",-1))]))]),_:1})]),_:1}),o.value?.installed?(r(),D(P,{key:0,class:"mb-4"},{default:l(()=>[a(T,{class:"text-primary-high"},{default:l(()=>[...e[13]||(e[13]=[p("Board Manager",-1)])]),_:1}),a(F,null,{default:l(()=>[a(I,{block:"",color:"primary",href:O.value,"prepend-icon":"mdi-open-in-new",rel:"noopener",size:"large",target:"_blank"},{default:l(()=>[...e[14]||(e[14]=[p("Open Board Manager",-1)])]),_:1},8,["href"]),s("div",Ye,f(O.value),1),R.value?(r(),i("div",Qe,[e[15]||(e[15]=p(" If that does not open, try ",-1)),s("a",{href:R.value,rel:"noopener",target:"_blank"},f(R.value),9,Xe)])):E("",!0)]),_:1})]),_:1})):E("",!0),a(P,null,{default:l(()=>[a(T,{class:"text-primary-high"},{default:l(()=>[p(f(o.value?.installed?"Update Autodarts":"Install Autodarts"),1)]),_:1}),a(F,null,{default:l(()=>[o.value?.installed?(r(),i("div",et,[o.value.update_available?(r(),i("div",tt,[a(Y,{icon:"mdi-arrow-up-circle",prominent:"",type:"info",variant:"tonal"},{default:l(()=>[e[17]||(e[17]=s("div",{class:"text-body-1 font-weight-medium mb-1"},"Update Available",-1)),s("div",at,"A new version (v"+f(o.value.latest_version)+") is available.",1)]),_:1}),a(I,{block:"",color:"primary",disabled:c.value!==null,loading:c.value==="update","prepend-icon":"mdi-arrow-up-circle",size:"large",onClick:ne},{default:l(()=>[p(" Update to v"+f(o.value.latest_version),1)]),_:1},8,["disabled","loading"])])):(r(),i("div",st,[a(M,{color:"success",icon:"mdi-check-circle",size:"64",style:{opacity:"0.3"}}),e[18]||(e[18]=s("div",{class:"text-body-1 text-success font-weight-medium mt-3"},"Up to Date",-1)),e[19]||(e[19]=s("div",{class:"text-caption text-secondary"},"You have the latest version installed",-1))])),a(I,{block:"",class:"mt-3",color:"primary",loading:S.value,"prepend-icon":"mdi-refresh",variant:"outlined",onClick:re},{default:l(()=>[...e[20]||(e[20]=[p("Check for Updates",-1)])]),_:1},8,["loading"])])):(r(),i("div",Ze,[a(Fe,{modelValue:V.value,"onUpdate:modelValue":e[1]||(e[1]=n=>V.value=n),class:"mb-4",density:"comfortable",hint:"e.g., 0.20.0",label:"Version (leave empty for latest)","persistent-hint":"",variant:"outlined"},null,8,["modelValue"]),a(je,{modelValue:U.value,"onUpdate:modelValue":e[2]||(e[2]=n=>U.value=n),class:"mb-4",color:"primary","hide-details":"",label:"Enable autostart"},null,8,["modelValue"]),a(I,{block:"",color:"primary",disabled:c.value!==null,loading:c.value==="install","prepend-icon":"mdi-download",size:"large",onClick:oe},{default:l(()=>[...e[16]||(e[16]=[p(" Install Autodarts ",-1)])]),_:1},8,["disabled","loading"])]))]),_:1})]),_:1})]),_:1}),a(Q,{cols:"12",lg:"6"},{default:l(()=>[a(P,{class:"logs-card"},{default:l(()=>[a(T,{class:"d-flex justify-space-between align-center"},{default:l(()=>[e[21]||(e[21]=s("span",{class:"text-primary-high"},"Service Logs",-1)),s("div",lt,[a($e,{modelValue:_.value,"onUpdate:modelValue":e[3]||(e[3]=n=>_.value=n),density:"compact","hide-details":"",items:[10,25,50,100,200,500],style:{"max-width":"100px"},variant:"outlined"},null,8,["modelValue"]),a(I,{icon:"mdi-refresh",loading:b.value,size:"small",variant:"text",onClick:w},null,8,["loading"])])]),_:1}),a(F,null,{default:l(()=>[b.value&&!x.value?(r(),i("div",ot,[a(K,{color:"primary",indeterminate:"",size:"48"})])):x.value?(r(),i("div",nt,[s("pre",rt,f(x.value),1)])):(r(),i("div",it,[a(M,{color:"secondary",icon:"mdi-text-box-outline",size:"48",style:{opacity:"0.3"}}),e[22]||(e[22]=s("div",{class:"text-caption text-secondary mt-2"},"No logs available",-1))]))]),_:1})]),_:1})]),_:1})]),_:1})]))]),_:1}))}},bt=me(dt,[["__scopeId","data-v-5c0e7747"]]);export{bt as default};
