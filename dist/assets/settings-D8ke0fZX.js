import{b as ie,_ as P,a as B,V as A}from"./VContainer-BLbpK7pH.js";import{C as oe,D as q,a$ as de,bs as re,E as ue,G as ce,H as fe,f as a,I as G,J as ve,a1 as K,r as u,K as me,e as i,S as Q,n as W,ae as pe,bt as ye,B as w,b0 as ge,k as ae,F as he,_ as be,bu as _e,v as we,o as ke,c as E,w as l,bv as xe,bw as Ve,u as Ce,q as F,d as C,j as J,h as r,bx as Se,V as S,i as O,t as X,s as Ue,by as Te,bz as De}from"./index-DGGnuvTw.js";import{V as Pe,a as Ae}from"./VRow-HPKKcC_3.js";import{u as Be,V as Y,a as Z,b as Fe,m as Ne}from"./VInput-BaS5DtEG.js";import{V as Ie}from"./VAlert-DNADlI5j.js";const Re=me({indeterminate:Boolean,inset:Boolean,flat:Boolean,loading:{type:[Boolean,String],default:!1},...Ne(),...Fe()},"VSwitch"),ee=oe()({name:"VSwitch",inheritAttrs:!1,props:Re(),emits:{"update:focused":s=>!0,"update:modelValue":s=>!0,"update:indeterminate":s=>!0},setup(s,y){let{attrs:f,slots:o}=y;const v=q(s,"indeterminate"),d=q(s,"modelValue"),{loaderClasses:k}=de(s),{isFocused:m,focus:g,blur:h}=Be(s),b=u(),n=u(),_=re&&window.matchMedia("(forced-colors: active)").matches,N=K(()=>typeof s.loading=="string"&&s.loading!==""?s.loading:s.color),x=ue(),I=K(()=>s.id||`switch-${x}`);function U(){v.value&&(v.value=!1)}function R(V){V.stopPropagation(),V.preventDefault(),b.value?.input?.click()}return ce(()=>{const[V,T]=fe(f),z=Y.filterProps(s),$=Z.filterProps(s);return a(Y,G({ref:n,class:["v-switch",{"v-switch--flat":s.flat},{"v-switch--inset":s.inset},{"v-switch--indeterminate":v.value},k.value,s.class]},V,z,{modelValue:d.value,"onUpdate:modelValue":t=>d.value=t,id:I.value,focused:m.value,style:s.style}),{...o,default:t=>{let{id:e,messagesId:c,isDisabled:te,isReadonly:le,isValid:H}=t;const j={model:d,isValid:H};return a(Z,G({ref:b},$,{modelValue:d.value,"onUpdate:modelValue":[D=>d.value=D,U],id:e.value,"aria-describedby":c.value,type:"checkbox","aria-checked":v.value?"mixed":void 0,disabled:te.value,readonly:le.value,onFocus:g,onBlur:h},T),{...o,default:D=>{let{backgroundColorClasses:M,backgroundColorStyles:p}=D;return i("div",{class:W(["v-switch__track",_?void 0:M.value]),style:Q(p.value),onClick:R},[o["track-true"]&&i("div",{key:"prepend",class:"v-switch__track-true"},[o["track-true"](j)]),o["track-false"]&&i("div",{key:"append",class:"v-switch__track-false"},[o["track-false"](j)])])},input:D=>{let{inputNode:M,icon:p,backgroundColorClasses:se,backgroundColorStyles:ne}=D;return i(he,null,[M,i("div",{class:W(["v-switch__thumb",{"v-switch__thumb--filled":p||s.loading},s.inset||_?void 0:se.value]),style:Q(s.inset?void 0:ne.value)},[o.thumb?a(pe,{defaults:{VIcon:{icon:p,size:"x-small"}}},{default:()=>[o.thumb({...j,icon:p})]}):a(ye,null,{default:()=>[s.loading?a(ge,{name:"v-switch",active:!0,color:H.value===!1?void 0:N.value},{default:L=>o.loader?o.loader(L):a(ae,{active:L.isActive,color:L.color,indeterminate:!0,size:"16",width:"2"},null)}):p&&a(w,{key:String(p),icon:p,size:"x-small"},null)]})])])}})}})}),ve({},n)}}),ze={key:0,class:"text-center py-16"},$e={key:1},je={class:"d-flex flex-column ga-3"},Me={class:"d-flex flex-wrap ga-2"},Le={class:"text-body-2"},Ee={key:0,class:"text-caption mt-1"},Je={class:"d-flex flex-column flex-sm-row gap-3 justify-end"},Oe={__name:"settings",setup(s){const{success:y,error:f}=Ce(),o=_e(),v=u(!1),d=u(!1),k=u(!1),m=u(null),g=u(!1),h=u(!1),b=u(null),n=u({auto_update:{enabled:!1,check_interval_hours:24,check_time:"03:00",auto_install:!1},notifications:{update_available:!0,installation_complete:!0},display:{theme:"dark",refresh_interval_seconds:5}});function _(t){const e=t==="light"?"light":"dark";o.change(e),localStorage.setItem("vertex-theme",e)}we(()=>n.value.display.theme,t=>{_(t)});const N=F(()=>m.value?JSON.stringify(m.value)!==JSON.stringify(n.value):!1),x=F(()=>(b.value?.components||[]).some(t=>t.update_available)),I=F(()=>{const t=(b.value?.components||[]).find(e=>e.update_available);return t?`${t.name}: ${t.current_version} â†’ ${t.latest_version}`:""}),U=F(()=>b.value?x.value?{type:"warning",message:'Update available. Click "Update now" to install.'}:{type:"success",message:"Device is up to date."}:null);async function R(){try{v.value=!0;const t=await xe();m.value=t.data,n.value=structuredClone(t.data),n.value.display.refresh_interval_seconds=5,_(n.value.display.theme)}catch(t){f("Failed to load settings: "+t.message)}finally{v.value=!1}}async function V(){try{d.value=!0,n.value.display.refresh_interval_seconds=5;const t=await De(n.value);m.value=t.data.settings,n.value=structuredClone(t.data.settings),n.value.display.refresh_interval_seconds=5,_(n.value.display.theme),y("Settings saved successfully")}catch(t){f("Failed to save settings: "+t.message)}finally{d.value=!1}}async function T(){try{g.value=!0;const t=await Ve();b.value=t.data,x.value?y("Update available"):y("Device is up to date")}catch(t){f("Failed to check for updates: "+t.message)}finally{g.value=!1}}async function z(){try{h.value=!0;const e=(await Ue()).data||{};if(e.started||e.success){const c=e.job_id?` (job ${e.job_id})`:"";y(`Update started${c}. The device will restart when finished.`)}else f(e.error||"Update command failed");await T()}catch(t){f("Failed to apply updates: "+t.message)}finally{h.value=!1}}async function $(){if(confirm("Are you sure you want to reset all settings to defaults?"))try{k.value=!0;const t=await Te();m.value=t.data.settings,n.value=structuredClone(t.data.settings),n.value.display.refresh_interval_seconds=5,_(n.value.display.theme),y("Settings reset to defaults")}catch(t){f("Failed to reset settings: "+t.message)}finally{k.value=!1}}return ke(async()=>{await R(),await T()}),(t,e)=>(C(),E(ie,{class:"pa-4 pa-md-6",fluid:""},{default:l(()=>[e[18]||(e[18]=i("div",{class:"mb-6"},[i("h1",{class:"text-h4 text-md-h3 text-primary-high font-weight-bold mb-1"},"Settings"),i("p",{class:"text-body-2 text-secondary"},"Configure theme and notifications")],-1)),v.value&&!m.value?(C(),J("div",ze,[a(ae,{color:"primary",indeterminate:"",size:"64"}),e[3]||(e[3]=i("div",{class:"text-body-1 text-secondary mt-4"},"Loading settings...",-1))])):(C(),J("div",$e,[a(Pe,null,{default:l(()=>[a(Ae,{cols:"12",lg:"6"},{default:l(()=>[a(P,{class:"mb-4",elevated:""},{default:l(()=>[a(B,{class:"text-primary-high d-flex align-center"},{default:l(()=>[a(w,{class:"mr-2",icon:"mdi-palette"}),e[4]||(e[4]=r("Display Settings ",-1))]),_:1}),a(A,null,{default:l(()=>[i("div",null,[e[7]||(e[7]=i("div",{class:"text-body-2 text-primary-medium mb-3"},"Theme",-1)),a(Se,{modelValue:n.value.display.theme,"onUpdate:modelValue":e[0]||(e[0]=c=>n.value.display.theme=c),class:"w-100",color:"primary",divided:"",mandatory:"",variant:"outlined"},{default:l(()=>[a(S,{class:"flex-1-1",value:"dark"},{default:l(()=>[a(w,{class:"mr-2",icon:"mdi-weather-night"}),e[5]||(e[5]=r("Dark",-1))]),_:1}),a(S,{class:"flex-1-1",value:"light"},{default:l(()=>[a(w,{class:"mr-2",icon:"mdi-white-balance-sunny"}),e[6]||(e[6]=r("Light",-1))]),_:1})]),_:1},8,["modelValue"]),e[8]||(e[8]=i("div",{class:"text-caption text-secondary mt-3"},"Dashboard data refresh is fixed at every 5 seconds.",-1))])]),_:1})]),_:1}),a(P,{class:"mb-4"},{default:l(()=>[a(B,{class:"text-primary-high d-flex align-center"},{default:l(()=>[a(w,{class:"mr-2",icon:"mdi-bell"}),e[9]||(e[9]=r("Notifications",-1))]),_:1}),a(A,null,{default:l(()=>[a(ee,{modelValue:n.value.notifications.update_available,"onUpdate:modelValue":e[1]||(e[1]=c=>n.value.notifications.update_available=c),class:"mb-4",color:"primary","hide-details":"",label:"Notify when updates are available"},null,8,["modelValue"]),a(ee,{modelValue:n.value.notifications.installation_complete,"onUpdate:modelValue":e[2]||(e[2]=c=>n.value.notifications.installation_complete=c),color:"primary","hide-details":"",label:"Notify when installation completes"},null,8,["modelValue"])]),_:1})]),_:1}),a(P,null,{default:l(()=>[a(B,{class:"text-primary-high d-flex align-center"},{default:l(()=>[a(w,{class:"mr-2",icon:"mdi-wifi"}),e[10]||(e[10]=r("Network Setup ",-1))]),_:1}),a(A,null,{default:l(()=>[...e[11]||(e[11]=[i("p",{class:"text-body-2 text-secondary mb-0"}," Network onboarding is now handled by the backend host flow before the dashboard loads. ",-1)])]),_:1})]),_:1}),a(P,{class:"mt-4"},{default:l(()=>[a(B,{class:"text-primary-high d-flex align-center"},{default:l(()=>[a(w,{class:"mr-2",icon:"mdi-update"}),e[12]||(e[12]=r("Check for Updates ",-1))]),_:1}),a(A,null,{default:l(()=>[i("div",je,[e[15]||(e[15]=i("p",{class:"text-body-2 text-secondary mb-0"},"Use this to check for software updates and apply them manually.",-1)),i("div",Me,[a(S,{color:"primary",disabled:g.value||h.value,loading:g.value,"prepend-icon":"mdi-refresh",variant:"outlined",onClick:T},{default:l(()=>[...e[13]||(e[13]=[r("Check for updates",-1)])]),_:1},8,["disabled","loading"]),x.value?(C(),E(S,{key:0,color:"warning",disabled:g.value||h.value,loading:h.value,"prepend-icon":"mdi-download",onClick:z},{default:l(()=>[...e[14]||(e[14]=[r("Update now",-1)])]),_:1},8,["disabled","loading"])):O("",!0)]),U.value?(C(),E(Ie,{key:0,density:"comfortable",type:U.value.type,variant:"tonal"},{default:l(()=>[i("div",Le,X(U.value.message),1),x.value?(C(),J("div",Ee,X(I.value),1)):O("",!0)]),_:1},8,["type"])):O("",!0)])]),_:1})]),_:1})]),_:1})]),_:1}),a(P,{class:"mt-6"},{default:l(()=>[a(A,null,{default:l(()=>[i("div",Je,[a(S,{color:"error",disabled:d.value,loading:k.value,"prepend-icon":"mdi-restore",variant:"outlined",onClick:$},{default:l(()=>[...e[16]||(e[16]=[r("Reset to Defaults",-1)])]),_:1},8,["disabled","loading"]),a(S,{color:"primary",disabled:k.value||!N.value,loading:d.value,"prepend-icon":"mdi-content-save",size:"large",onClick:V},{default:l(()=>[...e[17]||(e[17]=[r("Save Settings",-1)])]),_:1},8,["disabled","loading"])])]),_:1})]),_:1})]))]),_:1}))}},We=be(Oe,[["__scopeId","data-v-10fcfaf8"]]);export{We as default};
